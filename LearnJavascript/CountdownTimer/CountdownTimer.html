<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
		<title>Countdown Timer</title>
		<style type="text/css">
			input{
			    padding-bottom: 0px;
				padding-top: 0px;
				border-top-width: 0px;
				border-left-width: 0px;
				border-right-width: 0px;
				width:100%;
			}
		</style>
	</head>
	
	<body>
		<span id="numbers" style="white-space:nowrap;"></span>
		
		<table id="table1" >
			<tr>
				<td style="background-color:red;padding:3px;"></td>
				<td></td>
			</tr>
		</table>
		
		<table id="table2">
			<tr>
				<td style="width:80%;">
					<input id="content"/>
				</td>
				<td style="text-align:center;background-color:rgb(41, 74, 155);">
					<span style="color:white;width:100%;">Export</span>
				</td>
			</tr>
		</table>

		
		<audio id='music'>
		  <source src="music/Windows XP 启动.wav" type="audio/mpeg">
		  Your browser does not support the audio tag.
		</audio>
		
		<audio id='music2'>
		  <source src="music/Windows XP 关机.wav" type="audio/mpeg">
		  Your browser does not support the audio tag.
		</audio>
		
		<script type="text/javascript" >

			var timer = {
				initMinutes:30,
				restSeconds:0,
				minute:0,
				second:0,
				handle:0,
				stopFlag:false,
				setFontSize:function(){
					document.getElementById("numbers").style.fontSize = (window.innerWidth
								|| document.documentElement.clientWidth
								|| document.body.clientWidth) / 3 + "px"
				},
				init:function(){
					var span = document.getElementById('numbers')
					this.setFontSize()
					
					this.restSeconds = this.initMinutes * 60 
					this.minute = this.initMinutes
					
					//进度条
					var table = document.getElementById("table1")

					var table2 = document.getElementById("table2")

					var obj = this
					
					this.handle = setInterval(function(){
						
						if(obj.stopFlag)
							return
						
						if(obj.restSeconds > 0){
							span.innerHTML = "" + (obj.minute < 10 ? "0" + obj.minute : obj.minute) + ":" + (obj.second < 10 ? "0" + obj.second : obj.second)
							
							obj.restSeconds -= 1
						
							obj.minute =  Math.floor(obj.restSeconds / 60)
							obj.second =  obj.restSeconds - obj.minute * 60
							
							//刷新进度条
							table2.style.width = table.style.width = span.offsetWidth + "px"
							
							document.querySelector('#table1 td').style.width = (obj.restSeconds / (obj.initMinutes * 60) * 100) + "%"
							
							
						}else{
							span.innerHTML = "Time's Up"
							window.clearInterval(obj.handle)
							document.getElementById("music2").play()
							//span.style.fontSize = "1500%"
							
							//不停地闪烁
							window.setInterval(function(){
								span.style.display = (span.style.display=="none"?"initial":"none")
							}, 800)
							
						}
						
					}, 1000)
					
					document.getElementById("music").play()
				}
			}

			//main
			window.onload = function(){
				timer.init()
			}
			
			window.onresize = function(){
				timer.setFontSize()
			}
			
			//pause
			window.onclick = function(){
				//timer.stopFlag = !timer.stopFlag
			}

		</script>
	</body>
</html> 